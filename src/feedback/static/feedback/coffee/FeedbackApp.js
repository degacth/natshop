// Generated by CoffeeScript 1.8.0
(function() {
  angular.module("FeedbackApp", ['ngResource', 'vcRecaptcha']).config(function($httpProvider) {
    return $httpProvider.defaults.headers.common['X-CSRFToken'] = window.ng_config.api.csrf;
  }).controller("FeedbackFormController", function($scope, FeedbackModel) {
    return angular.extend($scope, {
      feedback: {},
      messages: {},
      submit: function() {
        var fb;
        if (this.FeedbackForm.$valid) {
          this.messages = {};
          fb = new FeedbackModel(this.feedback);
          return fb.$save(function(data) {
            return $scope.messages.success = 'Сообщение успешно отправлено';
          }, function(data) {
            return $scope.messages.errors = data.data;
          });
        }
      },
      captcha_success: function(res) {
        return $scope.feedback.captcha = res;
      }
    });
  }).factory('FeedbackModel', function($resource) {
    return $resource("" + window.ng_config.api.url + "/feedback/:id", {
      id: "@id"
    }, {}, {
      stripTrailingSlashes: false
    });
  });

}).call(this);
